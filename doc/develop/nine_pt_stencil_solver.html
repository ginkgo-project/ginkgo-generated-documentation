<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ginkgo: The nine-pt-stencil-solver program</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_doc.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Ginkgo
   &#160;<span id="projectnumber">Generated from pipelines/1294083411 branch based on develop. Ginkgo version 1.8.0</span>
   </div>
   <div id="projectbrief">A numerical linear algebra library targeting many-core architectures</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">The nine-pt-stencil-solver program </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The 9-point stencil example..</p>
<p>This example depends on simple-solver, three-pt-stencil-solver, poisson-solver.</p>
<p> 
<table class="example" width="50%">
<tr><th colspan="2"><b><small>Table of contents</small></b></th></tr>
<tr><td width="50%" valign="top">
<ol>
  <li> <a href="#Intro" class=bold>Introduction</a>
    <ul>
        <li><a href="#Abouttheexample"> About the example </a>
    </ul>
  <li> <a href="#CommProg" class=bold>The commented program</a>
    <ul>
      </ul>
</ol></td><td width="50%" valign="top"><ol>
  <li value="3"> <a href="#Results" class=bold>Results</a>
    <ul>
        <li><a href="#Commentsaboutprogramminganddebugging"> Comments about programming and debugging </a>
    </ul>
  <li> <a href="#PlainProg" class=bold>The plain program</a>
</ol> </td> </tr> </table>
 <a class="anchor" id="Intro"></a> <a class="anchor" id="Introduction"></a></p><h1>Introduction</h1>
<p>This example solves a 2D Poisson equation:</p>
<p>[ \Omega = (0,1)^2 \ \Omega_b = [0,1]^2 \text{ (with boundary)} \ \partial\Omega = \Omega_b \backslash \Omega \ u : \Omega_b -&gt; R \ u'' = f \in \Omega \ u = u_D \in \partial\Omega \ ]</p>
<p>using a finite difference method on an equidistant grid with <code>K</code> discretization points (<code>K</code> can be controlled with a command line parameter). The discretization may be done by any order Taylor polynomial. For an equidistant grid with K "inner" discretization points ((x1,y1), \ldots, (xk,y1),(x1,y2), \ldots, (xk,yk,z1)) step size (h = 1 / (K + 1)) and a stencil (\in \mathbb{R}^{3 \times 3}), the formula produces a system of linear equations</p>
<p>(\sum_{a,b=-1}^1 stencil(a,b) * u_{(i+a,j+b} = -f_k h^2), on any inner node with a neighborhood of inner nodes</p>
<p>On any node, where neighbor is on the border, the neighbor is replaced with a (-stencil(a,b) * u_{i+a,j+b}) and added to the right hand side vector. For example a node with a neighborhood of only edge nodes may look like this</p>
<p>[ \sum_{a,b=-1}^(1,0) stencil(a,b) * u_{(i+a,j+b} = -f_k h^2 - \sum_{a=-1}^1 stencil(a,1) * u_{(i+a,j+1} ]</p>
<p>which is then solved using Ginkgo's implementation of the CG method preconditioned with block-Jacobi. It is also possible to specify on which executor Ginkgo will solve the system via the command line. The function <code>f</code> is set to (f(x,y) = 6x + 6y) (making the solution (u(x,y) = x^3</p><ul>
<li>y^3)), but that can be changed in the <code>main</code> function. Also the stencil values for the core, the faces, the edge and the corners can be changed when passing additional parameters.</li>
</ul>
<p>The intention of this is to show how generation of stencil values and the right hand side vector changes when increasing the dimension.</p>
<p><a class="anchor" id="Abouttheexample"></a></p><h3>About the example </h3>
<p><a class="anchor" id="CommProg"></a> </p><h1>The commented program</h1>
<div class="fragment"><div class="line">preconditioned with block-Jacobi. It is also possible to specify on which</div>
<div class="line">executor Ginkgo will solve the system via the command line.</div>
<div class="line">The <span class="keyword">function</span> `f` is set to `f(x,y) = 6x + 6y` (making the solution `u(x,y) = x^3</div>
<div class="line">+ y^3`), but that can be changed in the `main` <span class="keyword">function</span>. Also the stencil values</div>
<div class="line"><span class="keywordflow">for</span> the core, the faces, the edge and the corners can be changed when passing</div>
<div class="line">additional parameters.</div>
<div class="line"> </div>
<div class="line">The intention of <span class="keyword">this</span> is to show how generation of stencil values and the right</div>
<div class="line">hand side vector changes when increasing the dimension.</div>
<div class="line">*****************************&lt;DESCRIPTION&gt;********************************** /</div>
<div class="line"> </div>
<div class="line">#include &lt;array&gt;</div>
<div class="line">#include &lt;chrono&gt;</div>
<div class="line">#include &lt;ginkgo/ginkgo.hpp&gt;</div>
<div class="line">#include &lt;iostream&gt;</div>
<div class="line">#include &lt;map&gt;</div>
<div class="line">#include &lt;string&gt;</div>
<div class="line">#include &lt;vector&gt;</div>
</div><!-- fragment --><p>Stencil values. Ordering can be seen in the main function Can also be changed by passing additional parameter when executing</p>
<div class="fragment"><div class="line">constexpr <span class="keywordtype">double</span> default_alpha = 10.0 / 3.0;</div>
<div class="line">constexpr <span class="keywordtype">double</span> default_beta = -2.0 / 3.0;</div>
<div class="line">constexpr <span class="keywordtype">double</span> default_gamma = -1.0 / 6.0;</div>
<div class="line"> </div>
<div class="line">/ * Possible alternative <span class="keywordflow">default</span> values are</div>
<div class="line"> * default_alpha = 8.0;</div>
<div class="line"> * default_beta = -1.0;</div>
<div class="line"> * default_gamma = -1.0;</div>
<div class="line"> * /</div>
</div><!-- fragment --><p>Creates a stencil matrix in CSR format for the given number of discretization points.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ValueType, <span class="keyword">typename</span> IndexType&gt;</div>
<div class="line"><span class="keywordtype">void</span> generate_stencil_matrix(IndexType dp, IndexType* row_ptrs,</div>
<div class="line">                             IndexType* col_idxs, ValueType* values,</div>
<div class="line">                             ValueType* coefs)</div>
<div class="line">{</div>
<div class="line">    IndexType pos = 0;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">size_t</span> dp_2 = dp * dp;</div>
<div class="line">    row_ptrs[0] = pos;</div>
<div class="line">    <span class="keywordflow">for</span> (IndexType k = 0; k &lt; dp; ++k) {</div>
<div class="line">        <span class="keywordflow">for</span> (IndexType i = 0; i &lt; dp; ++i) {</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">size_t</span> index = i + k * dp;</div>
<div class="line">            <span class="keywordflow">for</span> (IndexType j = -1; j &lt;= 1; ++j) {</div>
<div class="line">                <span class="keywordflow">for</span> (IndexType l = -1; l &lt;= 1; ++l) {</div>
<div class="line">                    <span class="keyword">const</span> IndexType offset = l + 1 + 3 * (j + 1);</div>
<div class="line">                    <span class="keywordflow">if</span> ((k + j) &gt;= 0 &amp;&amp; (k + j) &lt; dp &amp;&amp; (i + l) &gt;= 0 &amp;&amp;</div>
<div class="line">                        (i + l) &lt; dp) {</div>
<div class="line">                        values[pos] = coefs[offset];</div>
<div class="line">                        col_idxs[pos] = index + l + dp * j;</div>
<div class="line">                        ++pos;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            row_ptrs[index + 1] = pos;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Generates the RHS vector given <code>f</code> and the boundary conditions.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Closure, <span class="keyword">typename</span> ClosureT, <span class="keyword">typename</span> ValueType,</div>
<div class="line">          <span class="keyword">typename</span> IndexType&gt;</div>
<div class="line"><span class="keywordtype">void</span> generate_rhs(IndexType dp, Closure f, ClosureT u, ValueType* rhs,</div>
<div class="line">                  ValueType* coefs)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">size_t</span> dp_2 = dp * dp;</div>
<div class="line">    <span class="keyword">const</span> ValueType h = 1.0 / (dp + 1.0);</div>
<div class="line">    <span class="keywordflow">for</span> (IndexType i = 0; i &lt; dp; ++i) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> yi = ValueType(i + 1) * h;</div>
<div class="line">        <span class="keywordflow">for</span> (IndexType j = 0; j &lt; dp; ++j) {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> xi = ValueType(j + 1) * h;</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> index = i * dp + j;</div>
<div class="line">            <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index] = -f(xi, yi) * h * h;</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p>Iterating over the edges to add boundary values and adding the overlapping 3x1 to the rhs</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; dp; ++i) {</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> xi = ValueType(i + 1) * h;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> index_top = i;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> index_bot = i + dp * (dp - 1);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_top] -= u(xi - h, 0.0) * coefs[0];</div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_top] -= u(xi, 0.0) * coefs[1];</div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_top] -= u(xi + h, 0.0) * coefs[2];</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_bot] -= u(xi - h, 1.0) * coefs[6];</div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_bot] -= u(xi, 1.0) * coefs[7];</div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_bot] -= u(xi + h, 1.0) * coefs[8];</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; dp; ++i) {</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> yi = ValueType(i + 1) * h;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> index_left = i * dp;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> index_right = i * dp + (dp - 1);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_left] -= u(0.0, yi - h) * coefs[0];</div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_left] -= u(0.0, yi) * coefs[3];</div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_left] -= u(0.0, yi + h) * coefs[6];</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_right] -= u(1.0, yi - h) * coefs[2];</div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_right] -= u(1.0, yi) * coefs[5];</div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_right] -= u(1.0, yi + h) * coefs[8];</div>
<div class="line">}</div>
</div><!-- fragment --><p>remove the double corner values</p>
<div class="fragment"><div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[0] += u(0.0, 0.0) * coefs[0];</div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[(dp - 1)] += u(1.0, 0.0) * coefs[2];</div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[(dp - 1) * dp] += u(0.0, 1.0) * coefs[6];</div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[dp * dp - 1] += u(1.0, 1.0) * coefs[8];</div>
<div class="line">}</div>
</div><!-- fragment --><p>Prints the solution <code>u</code>.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ValueType, <span class="keyword">typename</span> IndexType&gt;</div>
<div class="line"><span class="keywordtype">void</span> print_solution(IndexType dp, <span class="keyword">const</span> ValueType* u)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> (IndexType i = 0; i &lt; dp; ++i) {</div>
<div class="line">        <span class="keywordflow">for</span> (IndexType j = 0; j &lt; dp; ++j) {</div>
<div class="line">            std::cout &lt;&lt; u[i * dp + j] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line">        }</div>
<div class="line">        std::cout &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">    }</div>
<div class="line">    std::cout &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Computes the 1-norm of the error given the computed <code>u</code> and the correct solution function <code>correct_u</code>.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Closure, <span class="keyword">typename</span> ValueType, <span class="keyword">typename</span> IndexType&gt;</div>
<div class="line"><a class="code" href="namespacegko.html#afd46d554050c4ae90e84ea4fcd9a41f3">gko::remove_complex&lt;ValueType&gt;</a> calculate_error(IndexType dp, <span class="keyword">const</span> ValueType* u,</div>
<div class="line">                                               Closure correct_u)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> ValueType h = 1.0 / (dp + 1);</div>
<div class="line">    <a class="code" href="namespacegko.html#afd46d554050c4ae90e84ea4fcd9a41f3">gko::remove_complex&lt;ValueType&gt;</a> error = 0.0;</div>
<div class="line">    <span class="keywordflow">for</span> (IndexType j = 0; j &lt; dp; ++j) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> xi = ValueType(j + 1) * h;</div>
<div class="line">        <span class="keywordflow">for</span> (IndexType i = 0; i &lt; dp; ++i) {</div>
<div class="line">            <span class="keyword">using</span> std::abs;</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> yi = ValueType(i + 1) * h;</div>
<div class="line">            error +=</div>
<div class="line">                <a class="code" href="namespacegko.html#adeb470aaf293d7c5548392b2f451e8e4">abs</a>(u[i * dp + j] - correct_u(xi, yi)) / <a class="code" href="namespacegko.html#adeb470aaf293d7c5548392b2f451e8e4">abs</a>(correct_u(xi, yi));</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> error;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ValueType, <span class="keyword">typename</span> IndexType&gt;</div>
<div class="line"><span class="keywordtype">void</span> solve_system(<span class="keyword">const</span> std::string&amp; executor_string,</div>
<div class="line">                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> discretization_points, IndexType* row_ptrs,</div>
<div class="line">                  IndexType* col_idxs, ValueType* values, ValueType* rhs,</div>
<div class="line">                  ValueType* u, <a class="code" href="namespacegko.html#afd46d554050c4ae90e84ea4fcd9a41f3">gko::remove_complex&lt;ValueType&gt;</a> reduction_factor)</div>
<div class="line">{</div>
</div><!-- fragment --><p>Some shortcuts</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> vec = <a class="code" href="classgko_1_1matrix_1_1Dense.html">gko::matrix::Dense&lt;ValueType&gt;</a>;</div>
<div class="line"><span class="keyword">using</span> mtx = <a class="code" href="classgko_1_1matrix_1_1Csr.html">gko::matrix::Csr&lt;ValueType, IndexType&gt;</a>;</div>
<div class="line"><span class="keyword">using</span> cg = <a class="code" href="classgko_1_1solver_1_1Cg.html">gko::solver::Cg&lt;ValueType&gt;</a>;</div>
<div class="line"><span class="keyword">using</span> bj = <a class="code" href="classgko_1_1preconditioner_1_1Jacobi.html">gko::preconditioner::Jacobi&lt;ValueType, IndexType&gt;</a>;</div>
<div class="line"><span class="keyword">using</span> val_array = <a class="code" href="classgko_1_1array.html">gko::array&lt;ValueType&gt;</a>;</div>
<div class="line"><span class="keyword">using</span> idx_array = <a class="code" href="classgko_1_1array.html">gko::array&lt;IndexType&gt;</a>;</div>
<div class="line"><span class="keyword">const</span> <span class="keyword">auto</span>&amp; dp = discretization_points;</div>
<div class="line"><span class="keyword">const</span> <a class="code" href="namespacegko.html#a6e5c95df0ae4e47aab2f604a22d98ee7">gko::size_type</a> dp_2 = dp * dp;</div>
</div><!-- fragment --><p>Figure out where to run the code</p>
<div class="fragment"><div class="line">std::map&lt;std::string, std::function&lt;std::shared_ptr&lt;gko::Executor&gt;()&gt;&gt;</div>
<div class="line">    exec_map{</div>
<div class="line">        {<span class="stringliteral">&quot;omp&quot;</span>, [] { <span class="keywordflow">return</span> <a class="code" href="classgko_1_1OmpExecutor.html#a8930142a1913bcbcac4fb6c917f930d9">gko::OmpExecutor::create</a>(); }},</div>
<div class="line">        {<span class="stringliteral">&quot;cuda&quot;</span>,</div>
<div class="line">         [] {</div>
<div class="line">             <span class="keywordflow">return</span> <a class="code" href="classgko_1_1CudaExecutor.html#a6c423656c7c0eb53810cb77bb4a66d15">gko::CudaExecutor::create</a>(0,</div>
<div class="line">                                              <a class="code" href="classgko_1_1OmpExecutor.html#a8930142a1913bcbcac4fb6c917f930d9">gko::OmpExecutor::create</a>());</div>
<div class="line">         }},</div>
<div class="line">        {<span class="stringliteral">&quot;hip&quot;</span>,</div>
<div class="line">         [] {</div>
<div class="line">             <span class="keywordflow">return</span> <a class="code" href="classgko_1_1HipExecutor.html#aa0701fe1303e03a8331da7e95008100d">gko::HipExecutor::create</a>(0, <a class="code" href="classgko_1_1OmpExecutor.html#a8930142a1913bcbcac4fb6c917f930d9">gko::OmpExecutor::create</a>());</div>
<div class="line">         }},</div>
<div class="line">        {<span class="stringliteral">&quot;dpcpp&quot;</span>,</div>
<div class="line">         [] {</div>
<div class="line">             <span class="keywordflow">return</span> <a class="code" href="classgko_1_1DpcppExecutor.html#ae9b875dfe3af7f3f3f24071bfb2f895e">gko::DpcppExecutor::create</a>(0,</div>
<div class="line">                                               <a class="code" href="classgko_1_1OmpExecutor.html#a8930142a1913bcbcac4fb6c917f930d9">gko::OmpExecutor::create</a>());</div>
<div class="line">         }},</div>
<div class="line">        {<span class="stringliteral">&quot;reference&quot;</span>, [] { <span class="keywordflow">return</span> gko::ReferenceExecutor::create(); }}};</div>
</div><!-- fragment --><p>executor where Ginkgo will perform the computation</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keyword">auto</span> exec = exec_map.at(executor_string)();  <span class="comment">// throws if not valid</span></div>
</div><!-- fragment --><p>executor where the application initialized the data</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keyword">auto</span> app_exec = exec-&gt;get_master();</div>
</div><!-- fragment --><p>Tell Ginkgo to use the data in our application</p>
<p>Matrix: we have to set the executor of the matrix to the one where we want SpMVs to run (in this case <code>exec</code>). When creating array views, we have to specify the executor where the data is (in this case <code>app_exec</code>).</p>
<p>If the two do not match, Ginkgo will automatically create a copy of the data on <code>exec</code> (however, it will not copy the data back once it is done</p><ul>
<li>here this is not important since we are not modifying the matrix).</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">auto</span> matrix = mtx::create(</div>
<div class="line">    exec, <a class="code" href="structgko_1_1dim.html">gko::dim&lt;2&gt;</a>(dp_2),</div>
<div class="line">    val_array::view(app_exec, (3 * dp - 2) * (3 * dp - 2), values),</div>
<div class="line">    idx_array::view(app_exec, (3 * dp - 2) * (3 * dp - 2), col_idxs),</div>
<div class="line">    idx_array::view(app_exec, dp_2 + 1, row_ptrs));</div>
</div><!-- fragment --><p>RHS: similar to matrix</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> b = vec::create(exec, <a class="code" href="structgko_1_1dim.html">gko::dim&lt;2&gt;</a>(dp_2, 1),</div>
<div class="line">                     val_array::view(app_exec, dp_2, rhs), 1);</div>
</div><!-- fragment --><p>Solution: we have to be careful here - if the executors are different, once we compute the solution the array will not be automatically copied back to the original memory locations. Fortunately, whenever <code>apply</code> is called on a linear operator (e.g. matrix, solver) the arguments automatically get copied to the executor where the operator is, and copied back once the operation is completed. Thus, in this case, we can just define the solution on <code>app_exec</code>, and it will be automatically transferred to/from <code>exec</code> if needed.</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> x = vec::create(app_exec, <a class="code" href="structgko_1_1dim.html">gko::dim&lt;2&gt;</a>(dp_2, 1),</div>
<div class="line">                     val_array::view(app_exec, dp_2, u), 1);</div>
</div><!-- fragment --><p>Generate solver</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> solver_gen =</div>
<div class="line">    cg::build()</div>
<div class="line">        .with_criteria(gko::stop::Iteration::build().with_max_iters(dp_2),</div>
<div class="line">                       <a class="code" href="classgko_1_1stop_1_1ResidualNorm.html">gko::stop::ResidualNorm&lt;ValueType&gt;::build</a>()</div>
<div class="line">                           .with_reduction_factor(reduction_factor))</div>
<div class="line">        .with_preconditioner(bj::build())</div>
<div class="line">        .on(exec);</div>
<div class="line"><span class="keyword">auto</span> <a class="code" href="namespacegko_1_1log.html#a15f71654c6c4f4defc95f9359343fa27a7cbf673200498a0d1324f4330825202a">solver</a> = solver_gen-&gt;generate(<a class="code" href="namespacegko.html#acbd3fd6d07e498892881e8e2ab0b4167">gko::give</a>(matrix));</div>
</div><!-- fragment --><p>Solve system</p>
<div class="fragment"><div class="line">    <a class="code" href="namespacegko_1_1log.html#a15f71654c6c4f4defc95f9359343fa27a7cbf673200498a0d1324f4330825202a">solver</a>-&gt;apply(b, x);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">using</span> ValueType = double;</div>
<div class="line">    <span class="keyword">using</span> IndexType = int;</div>
</div><!-- fragment --><p>Print version information</p>
<div class="fragment"><div class="line">std::cout &lt;&lt; <a class="code" href="classgko_1_1version__info.html#a6daeb8a087cfb57fa055526fc133d8eb">gko::version_info::get</a>() &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (argc == 2 &amp;&amp; std::string(argv[1]) == <span class="stringliteral">&quot;--help&quot;</span>) {</div>
<div class="line">    std::cerr</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Usage: &quot;</span> &lt;&lt; argv[0]</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot; [executor] [DISCRETIZATION_POINTS] [alpha] [beta] [gamma]&quot;</span></div>
<div class="line">        &lt;&lt; std::endl;</div>
<div class="line">    std::exit(-1);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keyword">auto</span> executor_string = argc &gt;= 2 ? argv[1] : <span class="stringliteral">&quot;reference&quot;</span>;</div>
<div class="line"><span class="keyword">const</span> IndexType discretization_points =</div>
<div class="line">    argc &gt;= 3 ? std::atoi(argv[2]) : 100;</div>
<div class="line"><span class="keyword">const</span> ValueType alpha_c = argc &gt;= 4 ? std::atof(argv[3]) : default_alpha;</div>
<div class="line"><span class="keyword">const</span> ValueType beta_c = argc &gt;= 5 ? std::atof(argv[4]) : default_beta;</div>
<div class="line"><span class="keyword">const</span> ValueType gamma_c = argc &gt;= 6 ? std::atof(argv[5]) : default_gamma;</div>
</div><!-- fragment --><p>clang-format off</p>
<div class="fragment"><div class="line">std::array&lt;ValueType, 9&gt; coefs{</div>
<div class="line">    gamma_c, beta_c, gamma_c,</div>
<div class="line">        beta_c, alpha_c, beta_c,</div>
<div class="line">    gamma_c, beta_c, gamma_c};</div>
</div><!-- fragment --><p>clang-format on</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keyword">auto</span> dp = discretization_points;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">size_t</span> dp_2 = dp * dp;</div>
</div><!-- fragment --><p>problem:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> correct_u = [](ValueType x, ValueType y) {</div>
<div class="line">    <span class="keywordflow">return</span> x * x * x + y * y * y;</div>
<div class="line">};</div>
<div class="line"><span class="keyword">auto</span> f = [](ValueType x, ValueType y) {</div>
<div class="line">    <span class="keywordflow">return</span> ValueType(6) * x + ValueType(6) * y;</div>
<div class="line">};</div>
</div><!-- fragment --><p>matrix</p>
<div class="fragment"><div class="line">std::vector&lt;IndexType&gt; row_ptrs(dp_2 + 1);</div>
<div class="line">std::vector&lt;IndexType&gt; col_idxs((3 * dp - 2) * (3 * dp - 2));</div>
<div class="line">std::vector&lt;ValueType&gt; values((3 * dp - 2) * (3 * dp - 2));</div>
</div><!-- fragment --><p>right hand side</p>
<div class="fragment"><div class="line">std::vector&lt;ValueType&gt; <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>(dp_2);</div>
</div><!-- fragment --><p>solution</p>
<div class="fragment"><div class="line">std::vector&lt;ValueType&gt; u(dp_2, 0.0);</div>
<div class="line"> </div>
<div class="line">generate_stencil_matrix(dp, row_ptrs.data(), col_idxs.data(), values.data(),</div>
<div class="line">                        coefs.data());</div>
</div><!-- fragment --><p>looking for solution u = x^3: f = 6x, u(0) = 0, u(1) = 1</p>
<div class="fragment"><div class="line">generate_rhs(dp, f, correct_u, <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>.data(), coefs.data());</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <a class="code" href="namespacegko.html#afd46d554050c4ae90e84ea4fcd9a41f3">gko::remove_complex&lt;ValueType&gt;</a> reduction_factor = 1e-7;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> start_time = std::chrono::steady_clock::now();</div>
<div class="line">solve_system(executor_string, dp, row_ptrs.data(), col_idxs.data(),</div>
<div class="line">             values.data(), <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>.data(), u.data(), reduction_factor);</div>
<div class="line"><span class="keyword">auto</span> stop_time = std::chrono::steady_clock::now();</div>
<div class="line"><span class="keyword">auto</span> runtime_duration =</div>
<div class="line">    static_cast&lt;double&gt;(</div>
<div class="line">        std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(stop_time -</div>
<div class="line">                                                             start_time)</div>
<div class="line">            .count()) *</div>
<div class="line">    1e-6;</div>
</div><!-- fragment --><p>Uncomment to print the solution print_solution(dp, u.data());</p>
<div class="fragment"><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;The average relative error is &quot;</span></div>
<div class="line">              &lt;&lt; calculate_error(dp, u.data(), correct_u) /</div>
<div class="line">                     <span class="keyword">static_cast&lt;</span><a class="code" href="namespacegko.html#afd46d554050c4ae90e84ea4fcd9a41f3">gko::remove_complex&lt;ValueType&gt;</a><span class="keyword">&gt;</span>(dp_2)</div>
<div class="line">              &lt;&lt; std::endl;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;The runtime is &quot;</span> &lt;&lt; std::to_string(runtime_duration) &lt;&lt; <span class="stringliteral">&quot; ms&quot;</span></div>
<div class="line">              &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --><p> <a class="anchor" id="Results"></a></p><h1>Results</h1>
<p>The expected output should be</p>
<div class="fragment"><div class="line">The average relative error is 6.35715e-06</div>
<div class="line">The runtime is 167.320520 ms</div>
</div><!-- fragment --><p><a class="anchor" id="Commentsaboutprogramminganddebugging"></a></p><h3>Comments about programming and debugging </h3>
<p><a class="anchor" id="PlainProg"></a> </p><h1>The plain program</h1>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="comment">/*****************************&lt;DESCRIPTION&gt;***********************************</span></div>
<div class="line"><span class="comment">This example solves a 2D Poisson equation:</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    \Omega = (0,1)^2</span></div>
<div class="line"><span class="comment">    \Omega_b = [0,1]^2   (with boundary)</span></div>
<div class="line"><span class="comment">    \partial\Omega = \Omega_b \backslash \Omega</span></div>
<div class="line"><span class="comment">    u : \Omega_b -&gt; R</span></div>
<div class="line"><span class="comment">    u&#39;&#39; = f in \Omega</span></div>
<div class="line"><span class="comment">    u = u_D on \partial\Omega</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">using a finite difference method on an equidistant grid with `K` discretization</span></div>
<div class="line"><span class="comment">points (`K` can be controlled with a command line parameter). The discretization</span></div>
<div class="line"><span class="comment">may be done by any order Taylor polynomial.</span></div>
<div class="line"><span class="comment">For an equidistant grid with K &quot;inner&quot; discretization points (x1,y1), ...,</span></div>
<div class="line"><span class="comment">(xk,y1),(x1,y2), ..., (xk,yk) step size h = 1 / (K + 1) and a stencil \in</span></div>
<div class="line"><span class="comment">\R^{3 x 3}, the formula produces a system of linear equations</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\sum_{a,b=-1}^1 stencil(a,b) * u_{(i+a,j+b} = -f_k h^2,  on any inner node with</span></div>
<div class="line"><span class="comment">a neighborhood of inner nodes</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">On any node, where neighbor is on the border, the neighbor is replaced with a</span></div>
<div class="line"><span class="comment">&#39;-stencil(a,b) * u_{i+a,j+b}&#39; and added to the right hand side vector. For</span></div>
<div class="line"><span class="comment">example a node with a neighborhood of only edge nodes may look like this</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">\sum_{a,b=-1}^(1,0) stencil(a,b) * u_{(i+a,j+b} = -f_k h^2 - \sum_{a=-1}^1</span></div>
<div class="line"><span class="comment">stencil(a,1) * u_{(i+a,j+1}</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">which is then solved using Ginkgo&#39;s implementation of the CG method</span></div>
<div class="line"><span class="comment">preconditioned with block-Jacobi. It is also possible to specify on which</span></div>
<div class="line"><span class="comment">executor Ginkgo will solve the system via the command line.</span></div>
<div class="line"><span class="comment">The function `f` is set to `f(x,y) = 6x + 6y` (making the solution `u(x,y) = x^3</span></div>
<div class="line"><span class="comment">+ y^3`), but that can be changed in the `main` function. Also the stencil values</span></div>
<div class="line"><span class="comment">for the core, the faces, the edge and the corners can be changed when passing</span></div>
<div class="line"><span class="comment">additional parameters.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">The intention of this is to show how generation of stencil values and the right</span></div>
<div class="line"><span class="comment">hand side vector changes when increasing the dimension.</span></div>
<div class="line"><span class="comment">*****************************&lt;DESCRIPTION&gt;**********************************/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;array&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ginkgo/ginkgo.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line">constexpr <span class="keywordtype">double</span> default_alpha = 10.0 / 3.0;</div>
<div class="line">constexpr <span class="keywordtype">double</span> default_beta = -2.0 / 3.0;</div>
<div class="line">constexpr <span class="keywordtype">double</span> default_gamma = -1.0 / 6.0;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Possible alternative default values are</span></div>
<div class="line"><span class="comment"> * default_alpha = 8.0;</span></div>
<div class="line"><span class="comment"> * default_beta = -1.0;</span></div>
<div class="line"><span class="comment"> * default_gamma = -1.0;</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ValueType, <span class="keyword">typename</span> IndexType&gt;</div>
<div class="line"><span class="keywordtype">void</span> generate_stencil_matrix(IndexType dp, IndexType* row_ptrs,</div>
<div class="line">                             IndexType* col_idxs, ValueType* values,</div>
<div class="line">                             ValueType* coefs)</div>
<div class="line">{</div>
<div class="line">    IndexType pos = 0;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">size_t</span> dp_2 = dp * dp;</div>
<div class="line">    row_ptrs[0] = pos;</div>
<div class="line">    <span class="keywordflow">for</span> (IndexType k = 0; k &lt; dp; ++k) {</div>
<div class="line">        <span class="keywordflow">for</span> (IndexType i = 0; i &lt; dp; ++i) {</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">size_t</span> index = i + k * dp;</div>
<div class="line">            <span class="keywordflow">for</span> (IndexType j = -1; j &lt;= 1; ++j) {</div>
<div class="line">                <span class="keywordflow">for</span> (IndexType l = -1; l &lt;= 1; ++l) {</div>
<div class="line">                    <span class="keyword">const</span> IndexType offset = l + 1 + 3 * (j + 1);</div>
<div class="line">                    <span class="keywordflow">if</span> ((k + j) &gt;= 0 &amp;&amp; (k + j) &lt; dp &amp;&amp; (i + l) &gt;= 0 &amp;&amp;</div>
<div class="line">                        (i + l) &lt; dp) {</div>
<div class="line">                        values[pos] = coefs[offset];</div>
<div class="line">                        col_idxs[pos] = index + l + dp * j;</div>
<div class="line">                        ++pos;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            row_ptrs[index + 1] = pos;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Closure, <span class="keyword">typename</span> ClosureT, <span class="keyword">typename</span> ValueType,</div>
<div class="line">          <span class="keyword">typename</span> IndexType&gt;</div>
<div class="line"><span class="keywordtype">void</span> generate_rhs(IndexType dp, Closure f, ClosureT u, ValueType* rhs,</div>
<div class="line">                  ValueType* coefs)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">size_t</span> dp_2 = dp * dp;</div>
<div class="line">    <span class="keyword">const</span> ValueType h = 1.0 / (dp + 1.0);</div>
<div class="line">    <span class="keywordflow">for</span> (IndexType i = 0; i &lt; dp; ++i) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> yi = ValueType(i + 1) * h;</div>
<div class="line">        <span class="keywordflow">for</span> (IndexType j = 0; j &lt; dp; ++j) {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> xi = ValueType(j + 1) * h;</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> index = i * dp + j;</div>
<div class="line">            <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index] = -f(xi, yi) * h * h;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; dp; ++i) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> xi = ValueType(i + 1) * h;</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> index_top = i;</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> index_bot = i + dp * (dp - 1);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_top] -= u(xi - h, 0.0) * coefs[0];</div>
<div class="line">        <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_top] -= u(xi, 0.0) * coefs[1];</div>
<div class="line">        <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_top] -= u(xi + h, 0.0) * coefs[2];</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_bot] -= u(xi - h, 1.0) * coefs[6];</div>
<div class="line">        <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_bot] -= u(xi, 1.0) * coefs[7];</div>
<div class="line">        <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_bot] -= u(xi + h, 1.0) * coefs[8];</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; dp; ++i) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> yi = ValueType(i + 1) * h;</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> index_left = i * dp;</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> index_right = i * dp + (dp - 1);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_left] -= u(0.0, yi - h) * coefs[0];</div>
<div class="line">        <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_left] -= u(0.0, yi) * coefs[3];</div>
<div class="line">        <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_left] -= u(0.0, yi + h) * coefs[6];</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_right] -= u(1.0, yi - h) * coefs[2];</div>
<div class="line">        <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_right] -= u(1.0, yi) * coefs[5];</div>
<div class="line">        <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[index_right] -= u(1.0, yi + h) * coefs[8];</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[0] += u(0.0, 0.0) * coefs[0];</div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[(dp - 1)] += u(1.0, 0.0) * coefs[2];</div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[(dp - 1) * dp] += u(0.0, 1.0) * coefs[6];</div>
<div class="line">    <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>[dp * dp - 1] += u(1.0, 1.0) * coefs[8];</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ValueType, <span class="keyword">typename</span> IndexType&gt;</div>
<div class="line"><span class="keywordtype">void</span> print_solution(IndexType dp, <span class="keyword">const</span> ValueType* u)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> (IndexType i = 0; i &lt; dp; ++i) {</div>
<div class="line">        <span class="keywordflow">for</span> (IndexType j = 0; j &lt; dp; ++j) {</div>
<div class="line">            std::cout &lt;&lt; u[i * dp + j] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line">        }</div>
<div class="line">        std::cout &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">    }</div>
<div class="line">    std::cout &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Closure, <span class="keyword">typename</span> ValueType, <span class="keyword">typename</span> IndexType&gt;</div>
<div class="line"><a class="code" href="namespacegko.html#afd46d554050c4ae90e84ea4fcd9a41f3">gko::remove_complex&lt;ValueType&gt;</a> calculate_error(IndexType dp, <span class="keyword">const</span> ValueType* u,</div>
<div class="line">                                               Closure correct_u)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> ValueType h = 1.0 / (dp + 1);</div>
<div class="line">    <a class="code" href="namespacegko.html#afd46d554050c4ae90e84ea4fcd9a41f3">gko::remove_complex&lt;ValueType&gt;</a> error = 0.0;</div>
<div class="line">    <span class="keywordflow">for</span> (IndexType j = 0; j &lt; dp; ++j) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> xi = ValueType(j + 1) * h;</div>
<div class="line">        <span class="keywordflow">for</span> (IndexType i = 0; i &lt; dp; ++i) {</div>
<div class="line">            <span class="keyword">using</span> std::abs;</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> yi = ValueType(i + 1) * h;</div>
<div class="line">            error +=</div>
<div class="line">                <a class="code" href="namespacegko.html#adeb470aaf293d7c5548392b2f451e8e4">abs</a>(u[i * dp + j] - correct_u(xi, yi)) / <a class="code" href="namespacegko.html#adeb470aaf293d7c5548392b2f451e8e4">abs</a>(correct_u(xi, yi));</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> error;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ValueType, <span class="keyword">typename</span> IndexType&gt;</div>
<div class="line"><span class="keywordtype">void</span> solve_system(<span class="keyword">const</span> std::string&amp; executor_string,</div>
<div class="line">                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> discretization_points, IndexType* row_ptrs,</div>
<div class="line">                  IndexType* col_idxs, ValueType* values, ValueType* rhs,</div>
<div class="line">                  ValueType* u, <a class="code" href="namespacegko.html#afd46d554050c4ae90e84ea4fcd9a41f3">gko::remove_complex&lt;ValueType&gt;</a> reduction_factor)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">using</span> vec = <a class="code" href="classgko_1_1matrix_1_1Dense.html">gko::matrix::Dense&lt;ValueType&gt;</a>;</div>
<div class="line">    <span class="keyword">using</span> mtx = <a class="code" href="classgko_1_1matrix_1_1Csr.html">gko::matrix::Csr&lt;ValueType, IndexType&gt;</a>;</div>
<div class="line">    <span class="keyword">using</span> cg = <a class="code" href="classgko_1_1solver_1_1Cg.html">gko::solver::Cg&lt;ValueType&gt;</a>;</div>
<div class="line">    <span class="keyword">using</span> bj = <a class="code" href="classgko_1_1preconditioner_1_1Jacobi.html">gko::preconditioner::Jacobi&lt;ValueType, IndexType&gt;</a>;</div>
<div class="line">    <span class="keyword">using</span> val_array = <a class="code" href="classgko_1_1array.html">gko::array&lt;ValueType&gt;</a>;</div>
<div class="line">    <span class="keyword">using</span> idx_array = <a class="code" href="classgko_1_1array.html">gko::array&lt;IndexType&gt;</a>;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; dp = discretization_points;</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacegko.html#a6e5c95df0ae4e47aab2f604a22d98ee7">gko::size_type</a> dp_2 = dp * dp;</div>
<div class="line"> </div>
<div class="line">    std::map&lt;std::string, std::function&lt;std::shared_ptr&lt;gko::Executor&gt;()&gt;&gt;</div>
<div class="line">        exec_map{</div>
<div class="line">            {<span class="stringliteral">&quot;omp&quot;</span>, [] { <span class="keywordflow">return</span> <a class="code" href="classgko_1_1OmpExecutor.html#a8930142a1913bcbcac4fb6c917f930d9">gko::OmpExecutor::create</a>(); }},</div>
<div class="line">            {<span class="stringliteral">&quot;cuda&quot;</span>,</div>
<div class="line">             [] {</div>
<div class="line">                 <span class="keywordflow">return</span> <a class="code" href="classgko_1_1CudaExecutor.html#a6c423656c7c0eb53810cb77bb4a66d15">gko::CudaExecutor::create</a>(0,</div>
<div class="line">                                                  <a class="code" href="classgko_1_1OmpExecutor.html#a8930142a1913bcbcac4fb6c917f930d9">gko::OmpExecutor::create</a>());</div>
<div class="line">             }},</div>
<div class="line">            {<span class="stringliteral">&quot;hip&quot;</span>,</div>
<div class="line">             [] {</div>
<div class="line">                 <span class="keywordflow">return</span> <a class="code" href="classgko_1_1HipExecutor.html#aa0701fe1303e03a8331da7e95008100d">gko::HipExecutor::create</a>(0, <a class="code" href="classgko_1_1OmpExecutor.html#a8930142a1913bcbcac4fb6c917f930d9">gko::OmpExecutor::create</a>());</div>
<div class="line">             }},</div>
<div class="line">            {<span class="stringliteral">&quot;dpcpp&quot;</span>,</div>
<div class="line">             [] {</div>
<div class="line">                 <span class="keywordflow">return</span> <a class="code" href="classgko_1_1DpcppExecutor.html#ae9b875dfe3af7f3f3f24071bfb2f895e">gko::DpcppExecutor::create</a>(0,</div>
<div class="line">                                                   <a class="code" href="classgko_1_1OmpExecutor.html#a8930142a1913bcbcac4fb6c917f930d9">gko::OmpExecutor::create</a>());</div>
<div class="line">             }},</div>
<div class="line">            {<span class="stringliteral">&quot;reference&quot;</span>, [] { <span class="keywordflow">return</span> gko::ReferenceExecutor::create(); }}};</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> exec = exec_map.at(executor_string)();  <span class="comment">// throws if not valid</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> app_exec = exec-&gt;get_master();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> matrix = mtx::create(</div>
<div class="line">        exec, <a class="code" href="structgko_1_1dim.html">gko::dim&lt;2&gt;</a>(dp_2),</div>
<div class="line">        val_array::view(app_exec, (3 * dp - 2) * (3 * dp - 2), values),</div>
<div class="line">        idx_array::view(app_exec, (3 * dp - 2) * (3 * dp - 2), col_idxs),</div>
<div class="line">        idx_array::view(app_exec, dp_2 + 1, row_ptrs));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> b = vec::create(exec, <a class="code" href="structgko_1_1dim.html">gko::dim&lt;2&gt;</a>(dp_2, 1),</div>
<div class="line">                         val_array::view(app_exec, dp_2, rhs), 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> x = vec::create(app_exec, <a class="code" href="structgko_1_1dim.html">gko::dim&lt;2&gt;</a>(dp_2, 1),</div>
<div class="line">                         val_array::view(app_exec, dp_2, u), 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> solver_gen =</div>
<div class="line">        cg::build()</div>
<div class="line">            .with_criteria(gko::stop::Iteration::build().with_max_iters(dp_2),</div>
<div class="line">                           <a class="code" href="classgko_1_1stop_1_1ResidualNorm.html">gko::stop::ResidualNorm&lt;ValueType&gt;::build</a>()</div>
<div class="line">                               .with_reduction_factor(reduction_factor))</div>
<div class="line">            .with_preconditioner(bj::build())</div>
<div class="line">            .on(exec);</div>
<div class="line">    <span class="keyword">auto</span> <a class="code" href="namespacegko_1_1log.html#a15f71654c6c4f4defc95f9359343fa27a7cbf673200498a0d1324f4330825202a">solver</a> = solver_gen-&gt;generate(<a class="code" href="namespacegko.html#acbd3fd6d07e498892881e8e2ab0b4167">gko::give</a>(matrix));</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespacegko_1_1log.html#a15f71654c6c4f4defc95f9359343fa27a7cbf673200498a0d1324f4330825202a">solver</a>-&gt;apply(b, x);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">using</span> ValueType = double;</div>
<div class="line">    <span class="keyword">using</span> IndexType = int;</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <a class="code" href="classgko_1_1version__info.html#a6daeb8a087cfb57fa055526fc133d8eb">gko::version_info::get</a>() &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (argc == 2 &amp;&amp; std::string(argv[1]) == <span class="stringliteral">&quot;--help&quot;</span>) {</div>
<div class="line">        std::cerr</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;Usage: &quot;</span> &lt;&lt; argv[0]</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; [executor] [DISCRETIZATION_POINTS] [alpha] [beta] [gamma]&quot;</span></div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line">        std::exit(-1);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> executor_string = argc &gt;= 2 ? argv[1] : <span class="stringliteral">&quot;reference&quot;</span>;</div>
<div class="line">    <span class="keyword">const</span> IndexType discretization_points =</div>
<div class="line">        argc &gt;= 3 ? std::atoi(argv[2]) : 100;</div>
<div class="line">    <span class="keyword">const</span> ValueType alpha_c = argc &gt;= 4 ? std::atof(argv[3]) : default_alpha;</div>
<div class="line">    <span class="keyword">const</span> ValueType beta_c = argc &gt;= 5 ? std::atof(argv[4]) : default_beta;</div>
<div class="line">    <span class="keyword">const</span> ValueType gamma_c = argc &gt;= 6 ? std::atof(argv[5]) : default_gamma;</div>
<div class="line"> </div>
<div class="line">    std::array&lt;ValueType, 9&gt; coefs{</div>
<div class="line">        gamma_c, beta_c, gamma_c,</div>
<div class="line">        beta_c, alpha_c, beta_c,</div>
<div class="line">        gamma_c, beta_c, gamma_c};</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> dp = discretization_points;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">size_t</span> dp_2 = dp * dp;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> correct_u = [](ValueType x, ValueType y) {</div>
<div class="line">        <span class="keywordflow">return</span> x * x * x + y * y * y;</div>
<div class="line">    };</div>
<div class="line">    <span class="keyword">auto</span> f = [](ValueType x, ValueType y) {</div>
<div class="line">        <span class="keywordflow">return</span> ValueType(6) * x + ValueType(6) * y;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;IndexType&gt; row_ptrs(dp_2 + 1);</div>
<div class="line">    std::vector&lt;IndexType&gt; col_idxs((3 * dp - 2) * (3 * dp - 2));</div>
<div class="line">    std::vector&lt;ValueType&gt; values((3 * dp - 2) * (3 * dp - 2));</div>
<div class="line">    std::vector&lt;ValueType&gt; <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>(dp_2);</div>
<div class="line">    std::vector&lt;ValueType&gt; u(dp_2, 0.0);</div>
<div class="line"> </div>
<div class="line">    generate_stencil_matrix(dp, row_ptrs.data(), col_idxs.data(), values.data(),</div>
<div class="line">                            coefs.data());</div>
<div class="line">    generate_rhs(dp, f, correct_u, <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>.data(), coefs.data());</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacegko.html#afd46d554050c4ae90e84ea4fcd9a41f3">gko::remove_complex&lt;ValueType&gt;</a> reduction_factor = 1e-7;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> start_time = std::chrono::steady_clock::now();</div>
<div class="line">    solve_system(executor_string, dp, row_ptrs.data(), col_idxs.data(),</div>
<div class="line">                 values.data(), <a class="code" href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">rhs</a>.data(), u.data(), reduction_factor);</div>
<div class="line">    <span class="keyword">auto</span> stop_time = std::chrono::steady_clock::now();</div>
<div class="line">    <span class="keyword">auto</span> runtime_duration =</div>
<div class="line">        static_cast&lt;double&gt;(</div>
<div class="line">            std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(stop_time -</div>
<div class="line">                                                                 start_time)</div>
<div class="line">                .count()) *</div>
<div class="line">        1e-6;</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;The average relative error is &quot;</span></div>
<div class="line">              &lt;&lt; calculate_error(dp, u.data(), correct_u) /</div>
<div class="line">                     <span class="keyword">static_cast&lt;</span><a class="code" href="namespacegko.html#afd46d554050c4ae90e84ea4fcd9a41f3">gko::remove_complex&lt;ValueType&gt;</a><span class="keyword">&gt;</span>(dp_2)</div>
<div class="line">              &lt;&lt; std::endl;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;The runtime is &quot;</span> &lt;&lt; std::to_string(runtime_duration) &lt;&lt; <span class="stringliteral">&quot; ms&quot;</span></div>
<div class="line">              &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="aclassgko_1_1matrix_1_1Csr_html"><div class="ttname"><a href="classgko_1_1matrix_1_1Csr.html">gko::matrix::Csr</a></div><div class="ttdoc">CSR is a matrix format which stores only the nonzero coefficients by compressing each row of the matr...</div><div class="ttdef"><b>Definition:</b> matrix.hpp:26</div></div>
<div class="ttc" id="anamespacegko_1_1log_html_a15f71654c6c4f4defc95f9359343fa27a7cbf673200498a0d1324f4330825202a"><div class="ttname"><a href="namespacegko_1_1log.html#a15f71654c6c4f4defc95f9359343fa27a7cbf673200498a0d1324f4330825202a">gko::log::profile_event_category::solver</a></div><div class="ttdoc">Solver events.</div></div>
<div class="ttc" id="anamespacegko_html_acbd3fd6d07e498892881e8e2ab0b4167"><div class="ttname"><a href="namespacegko.html#acbd3fd6d07e498892881e8e2ab0b4167">gko::give</a></div><div class="ttdeci">std::remove_reference&lt; OwningPointer &gt;::type &amp;&amp; give(OwningPointer &amp;&amp;p)</div><div class="ttdoc">Marks that the object pointed to by p can be given to the callee.</div><div class="ttdef"><b>Definition:</b> utils_helper.hpp:249</div></div>
<div class="ttc" id="aclassgko_1_1matrix_1_1Dense_html"><div class="ttname"><a href="classgko_1_1matrix_1_1Dense.html">gko::matrix::Dense</a></div><div class="ttdoc">Dense is a matrix format which explicitly stores all values of the matrix.</div><div class="ttdef"><b>Definition:</b> dense_cache.hpp:20</div></div>
<div class="ttc" id="anamespacegko_html_a6e5c95df0ae4e47aab2f604a22d98ee7"><div class="ttname"><a href="namespacegko.html#a6e5c95df0ae4e47aab2f604a22d98ee7">gko::size_type</a></div><div class="ttdeci">std::size_t size_type</div><div class="ttdoc">Integral type used for allocation quantities.</div><div class="ttdef"><b>Definition:</b> types.hpp:108</div></div>
<div class="ttc" id="anamespacegko_html_adeb470aaf293d7c5548392b2f451e8e4"><div class="ttname"><a href="namespacegko.html#adeb470aaf293d7c5548392b2f451e8e4">gko::abs</a></div><div class="ttdeci">constexpr xstd::enable_if_t&lt;!is_complex_s&lt; T &gt;::value, T &gt; abs(const T &amp;x)</div><div class="ttdoc">Returns the absolute value of the object.</div><div class="ttdef"><b>Definition:</b> math.hpp:1076</div></div>
<div class="ttc" id="aclassgko_1_1HipExecutor_html_aa0701fe1303e03a8331da7e95008100d"><div class="ttname"><a href="classgko_1_1HipExecutor.html#aa0701fe1303e03a8331da7e95008100d">gko::HipExecutor::create</a></div><div class="ttdeci">static std::shared_ptr&lt; HipExecutor &gt; create(int device_id, std::shared_ptr&lt; Executor &gt; master, bool device_reset, allocation_mode alloc_mode=default_hip_alloc_mode, CUstream_st *stream=nullptr)</div><div class="ttdoc">Creates a new HipExecutor.</div></div>
<div class="ttc" id="aclassgko_1_1version__info_html_a6daeb8a087cfb57fa055526fc133d8eb"><div class="ttname"><a href="classgko_1_1version__info.html#a6daeb8a087cfb57fa055526fc133d8eb">gko::version_info::get</a></div><div class="ttdeci">static const version_info &amp; get()</div><div class="ttdoc">Returns an instance of version_info.</div><div class="ttdef"><b>Definition:</b> version.hpp:140</div></div>
<div class="ttc" id="aclassgko_1_1preconditioner_1_1Jacobi_html"><div class="ttname"><a href="classgko_1_1preconditioner_1_1Jacobi.html">gko::preconditioner::Jacobi</a></div><div class="ttdoc">A block-Jacobi preconditioner is a block-diagonal linear operator, obtained by inverting the diagonal...</div><div class="ttdef"><b>Definition:</b> jacobi.hpp:185</div></div>
<div class="ttc" id="aclassgko_1_1array_html"><div class="ttname"><a href="classgko_1_1array.html">gko::array</a></div><div class="ttdoc">An array is a container which encapsulates fixed-sized arrays, stored on the Executor tied to the arr...</div><div class="ttdef"><b>Definition:</b> array.hpp:27</div></div>
<div class="ttc" id="aclassgko_1_1stop_1_1ResidualNorm_html"><div class="ttname"><a href="classgko_1_1stop_1_1ResidualNorm.html">gko::stop::ResidualNorm</a></div><div class="ttdoc">The ResidualNorm class is a stopping criterion which stops the iteration process when the actual resi...</div><div class="ttdef"><b>Definition:</b> residual_norm.hpp:110</div></div>
<div class="ttc" id="astructgko_1_1dim_html"><div class="ttname"><a href="structgko_1_1dim.html">gko::dim&lt; 2 &gt;</a></div></div>
<div class="ttc" id="aclassgko_1_1solver_1_1Cg_html"><div class="ttname"><a href="classgko_1_1solver_1_1Cg.html">gko::solver::Cg</a></div><div class="ttdoc">CG or the conjugate gradient method is an iterative type Krylov subspace method which is suitable for...</div><div class="ttdef"><b>Definition:</b> cg.hpp:46</div></div>
<div class="ttc" id="aclassgko_1_1CudaExecutor_html_a6c423656c7c0eb53810cb77bb4a66d15"><div class="ttname"><a href="classgko_1_1CudaExecutor.html#a6c423656c7c0eb53810cb77bb4a66d15">gko::CudaExecutor::create</a></div><div class="ttdeci">static std::shared_ptr&lt; CudaExecutor &gt; create(int device_id, std::shared_ptr&lt; Executor &gt; master, bool device_reset, allocation_mode alloc_mode=default_cuda_alloc_mode, CUstream_st *stream=nullptr)</div><div class="ttdoc">Creates a new CudaExecutor.</div></div>
<div class="ttc" id="anamespacegko_1_1solver_html_a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e"><div class="ttname"><a href="namespacegko_1_1solver.html#a82d21321745fbd3dc65c276d5838bb8aa83ff9f9e3dd7561d3dd91204cf546b7e">gko::solver::initial_guess_mode::rhs</a></div><div class="ttdoc">the input is right hand side</div></div>
<div class="ttc" id="aclassgko_1_1OmpExecutor_html_a8930142a1913bcbcac4fb6c917f930d9"><div class="ttname"><a href="classgko_1_1OmpExecutor.html#a8930142a1913bcbcac4fb6c917f930d9">gko::OmpExecutor::create</a></div><div class="ttdeci">static std::shared_ptr&lt; OmpExecutor &gt; create(std::shared_ptr&lt; CpuAllocatorBase &gt; alloc=std::make_shared&lt; CpuAllocator &gt;())</div><div class="ttdoc">Creates a new OmpExecutor.</div><div class="ttdef"><b>Definition:</b> executor.hpp:1345</div></div>
<div class="ttc" id="anamespacegko_html_afd46d554050c4ae90e84ea4fcd9a41f3"><div class="ttname"><a href="namespacegko.html#afd46d554050c4ae90e84ea4fcd9a41f3">gko::remove_complex</a></div><div class="ttdeci">typename detail::remove_complex_s&lt; T &gt;::type remove_complex</div><div class="ttdoc">Obtain the type which removed the complex of complex/scalar type or the template parameter of class b...</div><div class="ttdef"><b>Definition:</b> math.hpp:326</div></div>
<div class="ttc" id="aclassgko_1_1DpcppExecutor_html_ae9b875dfe3af7f3f3f24071bfb2f895e"><div class="ttname"><a href="classgko_1_1DpcppExecutor.html#ae9b875dfe3af7f3f3f24071bfb2f895e">gko::DpcppExecutor::create</a></div><div class="ttdeci">static std::shared_ptr&lt; DpcppExecutor &gt; create(int device_id, std::shared_ptr&lt; Executor &gt; master, std::string device_type=&quot;all&quot;, dpcpp_queue_property property=dpcpp_queue_property::in_order)</div><div class="ttdoc">Creates a new DpcppExecutor.</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>

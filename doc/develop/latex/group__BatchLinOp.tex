\hypertarget{group__BatchLinOp}{}\doxysection{Batch\+Lin\+Op}
\label{group__BatchLinOp}\index{BatchLinOp@{BatchLinOp}}
Collaboration diagram for Batch\+Lin\+Op\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__BatchLinOp}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classgko_1_1batch_1_1BatchLinOpFactory}{gko\+::batch\+::\+Batch\+Lin\+Op\+Factory}}
\begin{DoxyCompactList}\small\item\em A \mbox{\hyperlink{classgko_1_1batch_1_1BatchLinOpFactory}{Batch\+Lin\+Op\+Factory}} represents a higher order mapping which transforms one batch linear operator into another. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classgko_1_1batch_1_1EnableBatchLinOp}{gko\+::batch\+::\+Enable\+Batch\+Lin\+Op$<$ Concrete\+Batch\+Lin\+Op, Polymorphic\+Base $>$}}
\begin{DoxyCompactList}\small\item\em The \mbox{\hyperlink{classgko_1_1batch_1_1EnableBatchLinOp}{Enable\+Batch\+Lin\+Op}} mixin can be used to provide sensible default implementations of the majority of the \mbox{\hyperlink{classgko_1_1batch_1_1BatchLinOp}{Batch\+Lin\+Op}} and \mbox{\hyperlink{classgko_1_1PolymorphicObject}{Polymorphic\+Object}} interface. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classgko_1_1batch_1_1matrix_1_1Csr}{gko\+::batch\+::matrix\+::\+Csr$<$ Value\+Type, Index\+Type $>$}}
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{classgko_1_1batch_1_1matrix_1_1Csr}{Csr}} is a general sparse matrix format that stores the column indices for each nonzero entry and a cumulative sum of the number of nonzeros in each row. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classgko_1_1batch_1_1matrix_1_1Dense}{gko\+::batch\+::matrix\+::\+Dense$<$ Value\+Type $>$}}
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{classgko_1_1batch_1_1matrix_1_1Dense}{Dense}} is a batch matrix format which explicitly stores all values of the matrix in each of the batches. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classgko_1_1batch_1_1matrix_1_1Ell}{gko\+::batch\+::matrix\+::\+Ell$<$ Value\+Type, Index\+Type $>$}}
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{classgko_1_1batch_1_1matrix_1_1Ell}{Ell}} is a sparse matrix format that stores the same number of nonzeros in each row, enabling coalesced accesses. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classgko_1_1batch_1_1matrix_1_1Identity}{gko\+::batch\+::matrix\+::\+Identity$<$ Value\+Type $>$}}
\begin{DoxyCompactList}\small\item\em The batch \mbox{\hyperlink{classgko_1_1batch_1_1matrix_1_1Identity}{Identity}} matrix, which represents a batch of \mbox{\hyperlink{classgko_1_1batch_1_1matrix_1_1Identity}{Identity}} matrices. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classgko_1_1batch_1_1solver_1_1Bicgstab}{gko\+::batch\+::solver\+::\+Bicgstab$<$ Value\+Type $>$}}
\begin{DoxyCompactList}\small\item\em Bi\+C\+G\+S\+T\+AB or the Bi-\/\+Conjugate Gradient-\/\+Stabilized is a Krylov subspace solver. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{group__BatchLinOp_gab7f0cd5a4520a215974412e6fff4f25f}{G\+K\+O\+\_\+\+E\+N\+A\+B\+L\+E\+\_\+\+B\+A\+T\+C\+H\+\_\+\+L\+I\+N\+\_\+\+O\+P\+\_\+\+F\+A\+C\+T\+O\+RY}}(\+\_\+batch\+\_\+lin\+\_\+op,  \+\_\+parameters\+\_\+name,  \+\_\+factory\+\_\+name)
\begin{DoxyCompactList}\small\item\em This macro will generate a default implementation of a Batch\+Lin\+Op\+Factory for the Batch\+Lin\+Op subclass it is defined in. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename Concrete\+Factory , typename Concrete\+Batch\+Lin\+Op , typename Parameters\+Type , typename Polymorphic\+Base  = Batch\+Lin\+Op\+Factory$>$ }\\using \mbox{\hyperlink{group__BatchLinOp_ga544616e42045fcd07bfb3799d304eb0c}{gko\+::batch\+::\+Enable\+Default\+Batch\+Lin\+Op\+Factory}} = \mbox{\hyperlink{classgko_1_1EnableDefaultFactory}{Enable\+Default\+Factory}}$<$ Concrete\+Factory, Concrete\+Batch\+Lin\+Op, Parameters\+Type, Polymorphic\+Base $>$
\begin{DoxyCompactList}\small\item\em This is an alias for the \mbox{\hyperlink{classgko_1_1EnableDefaultFactory}{Enable\+Default\+Factory}} mixin, which correctly sets the template parameters to enable a subclass of \mbox{\hyperlink{classgko_1_1batch_1_1BatchLinOpFactory}{Batch\+Lin\+Op\+Factory}}. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\hypertarget{group__BatchLinOp_batch_linop_concept}{}\doxysubsection{Batched Linear operator as a concept}\label{group__BatchLinOp_batch_linop_concept}
A batch linear operator (\mbox{\hyperlink{classgko_1_1batch_1_1BatchLinOp}{Batch\+Lin\+Op}}) forms the base class for all batched linear algebra objects. In general, it follows the same structure as the \mbox{\hyperlink{classgko_1_1LinOp}{Lin\+Op}} class, but has some crucial differences which make it not strictly representable through or with the \mbox{\hyperlink{classgko_1_1LinOp}{Lin\+Op}} class.

A batched operator is defined as a set of independent linear operators which have no communication/information exchange between them. Therefore, any collective operations between the batches is not possible and not implemented. This allows for each batch to be computed and operated on in an embarrassingly parallel fashion.

A key difference between the \mbox{\hyperlink{classgko_1_1LinOp}{Lin\+Op}} and the \mbox{\hyperlink{classgko_1_1batch_1_1BatchLinOp}{Batch\+Lin\+Op}} class is that the apply between Batch\+Lin\+Ops is no longer supported. The user can apply a \mbox{\hyperlink{classgko_1_1batch_1_1BatchLinOp}{Batch\+Lin\+Op}} to a \mbox{\hyperlink{classgko_1_1batch_1_1MultiVector}{batch\+::\+Multi\+Vector}} but not to any general \mbox{\hyperlink{classgko_1_1batch_1_1BatchLinOp}{Batch\+Lin\+Op}}.

Therefore, the \mbox{\hyperlink{classgko_1_1batch_1_1BatchLinOp}{Batch\+Lin\+Op}} serves only as a base class providing necessary core functionality from Polymorphic object and store the dimensions of the batched object.

\begin{DoxyNote}{Note}
Apply to \mbox{\hyperlink{classgko_1_1batch_1_1MultiVector}{batch\+::\+Multi\+Vector}} objects are handled by the concrete \mbox{\hyperlink{classgko_1_1LinOp}{Lin\+Op}} and may be moved to the base \mbox{\hyperlink{classgko_1_1batch_1_1BatchLinOp}{Batch\+Lin\+Op}} class in the future.
\end{DoxyNote}
\mbox{\hyperlink{group__BatchLinOp}{Batch\+Lin\+Op}} 

\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{group__BatchLinOp_gab7f0cd5a4520a215974412e6fff4f25f}\label{group__BatchLinOp_gab7f0cd5a4520a215974412e6fff4f25f}} 
\index{BatchLinOp@{BatchLinOp}!GKO\_ENABLE\_BATCH\_LIN\_OP\_FACTORY@{GKO\_ENABLE\_BATCH\_LIN\_OP\_FACTORY}}
\index{GKO\_ENABLE\_BATCH\_LIN\_OP\_FACTORY@{GKO\_ENABLE\_BATCH\_LIN\_OP\_FACTORY}!BatchLinOp@{BatchLinOp}}
\doxysubsubsection{\texorpdfstring{GKO\_ENABLE\_BATCH\_LIN\_OP\_FACTORY}{GKO\_ENABLE\_BATCH\_LIN\_OP\_FACTORY}}
{\footnotesize\ttfamily \#define G\+K\+O\+\_\+\+E\+N\+A\+B\+L\+E\+\_\+\+B\+A\+T\+C\+H\+\_\+\+L\+I\+N\+\_\+\+O\+P\+\_\+\+F\+A\+C\+T\+O\+RY(\begin{DoxyParamCaption}\item[{}]{\+\_\+batch\+\_\+lin\+\_\+op,  }\item[{}]{\+\_\+parameters\+\_\+name,  }\item[{}]{\+\_\+factory\+\_\+name }\end{DoxyParamCaption})}



This macro will generate a default implementation of a Batch\+Lin\+Op\+Factory for the Batch\+Lin\+Op subclass it is defined in. 

It is required to first call the macro \mbox{\hyperlink{group__LinOp_ga1fc8e9d8be0c9ad2d72bc1ddfc6d8358}{G\+K\+O\+\_\+\+C\+R\+E\+A\+T\+E\+\_\+\+F\+A\+C\+T\+O\+R\+Y\+\_\+\+P\+A\+R\+A\+M\+E\+T\+E\+R\+S()}} before this one in order to instantiate the parameters type first.

The list of parameters for the factory should be defined in a code block after the macro definition, and should contain a list of G\+K\+O\+\_\+\+F\+A\+C\+T\+O\+R\+Y\+\_\+\+P\+A\+R\+A\+M\+E\+T\+E\+R\+\_\+$\ast$ declarations. The class should provide a constructor with signature \+\_\+batch\+\_\+lin\+\_\+op(const \+\_\+factory\+\_\+name $\ast$, std\+::shared\+\_\+ptr$<$const Batch\+Lin\+Op$>$) which the factory will use a callback to construct the object.

A minimal example of a batch linear operator is the following\+:

\`{}\`{}\`{}c++ struct My\+Batch\+Lin\+Op \+: public Enable\+Batch\+Lin\+Op$<$\+My\+Batch\+Lin\+Op$>$ \{ \mbox{\hyperlink{group__BatchLinOp_gab7f0cd5a4520a215974412e6fff4f25f}{G\+K\+O\+\_\+\+E\+N\+A\+B\+L\+E\+\_\+\+B\+A\+T\+C\+H\+\_\+\+L\+I\+N\+\_\+\+O\+P\+\_\+\+F\+A\+C\+T\+O\+R\+Y(\+My\+Batch\+Lin\+Op, my\+\_\+parameters, Factory)}} \{ // a factory parameter named \char`\"{}my\+\_\+value\char`\"{}, of type int and default // value of 5 int \mbox{\hyperlink{group__LinOp_ga49d4c09c39f06b22bebbbfd1d8bfe450}{G\+K\+O\+\_\+\+F\+A\+C\+T\+O\+R\+Y\+\_\+\+P\+A\+R\+A\+M\+E\+T\+E\+R\+\_\+\+S\+C\+A\+L\+A\+R(my\+\_\+value, 5)}}; // a factory parameter named {\ttfamily my\+\_\+pair} of type {\ttfamily std\+::pair$<$int,int$>$} // and default value \{5, 5\} std\+::pair$<$int, int$>$ \mbox{\hyperlink{group__LinOp_gaa292314d27ec1fb7ad54debaa3606ea8}{G\+K\+O\+\_\+\+F\+A\+C\+T\+O\+R\+Y\+\_\+\+P\+A\+R\+A\+M\+E\+T\+E\+R\+\_\+\+V\+E\+C\+T\+O\+R(my\+\_\+pair, 5, 5)}}; \}; // constructor needed by Enable\+Batch\+Lin\+Op explicit My\+Batch\+Lin\+Op(std\+::shared\+\_\+ptr$<$const Executor$>$ exec) \{ \+: Enable\+Batch\+Lin\+Op$<$\+My\+Batch\+Lin\+Op$>$(exec) \{\} // constructor needed by the factory explicit My\+Batch\+Lin\+Op(const Factory $\ast$factory, std\+::shared\+\_\+ptr$<$const Batch\+Lin\+Op$>$ matrix) \+: Enable\+Batch\+Lin\+Op$<$\+My\+Batch\+Lin\+Op$>$(factory-\/$>$get\+\_\+executor()), matrix-\/$>$get\+\_\+size()), // store factory\textquotesingle{}s parameters locally my\+\_\+parameters\+\_\+\{factory-\/$>$get\+\_\+parameters()\} \{ int value = my\+\_\+parameters\+\_\+.\+my\+\_\+value; // do something with value \} 
\begin{DoxyCode}{0}
\DoxyCodeLine{MyBatchLinOp can then be created \mbox{\hyperlink{namespacegko_a618c9b64c35b0452240e9e57a9673b94}{as}} follows:}
\DoxyCodeLine{}
\DoxyCodeLine{```c++}
\DoxyCodeLine{\textcolor{keyword}{auto} exec = gko::ReferenceExecutor::create();}
\DoxyCodeLine{\textcolor{comment}{// create a factory with default `my\_value` parameter}}
\DoxyCodeLine{\textcolor{keyword}{auto} fact = MyBatchLinOp::build().on(exec);}
\DoxyCodeLine{\textcolor{comment}{// create a operator using the factory:}}
\DoxyCodeLine{\textcolor{keyword}{auto} my\_op = fact-\/>generate(gko::batch::matrix::Identity::create(exec, 2));}
\DoxyCodeLine{std::cout << my\_op-\/>get\_my\_parameters().my\_value;  \textcolor{comment}{// prints 5}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// create a factory with custom `my\_value` parameter}}
\DoxyCodeLine{\textcolor{keyword}{auto} fact = MyLinOp::build().with\_my\_value(0).on(exec);}
\DoxyCodeLine{\textcolor{comment}{// create a operator using the factory:}}
\DoxyCodeLine{\textcolor{keyword}{auto} my\_op = fact-\/>generate(gko::batch::matrix::Identity::create(exec, 2));}
\DoxyCodeLine{std::cout << my\_op-\/>get\_my\_parameters().my\_value;  \textcolor{comment}{// prints 0}}
\end{DoxyCode}


\begin{DoxyNote}{Note}
It is possible to combine both the \#\+G\+K\+O\+\_\+\+C\+R\+E\+A\+T\+E\+\_\+\+F\+A\+C\+T\+O\+R\+Y\+\_\+\+P\+A\+R\+A\+M\+E\+T\+E\+R\+\_\+$\ast$() macros with this one in a unique macro for class {\bfseries{templates}} (not with regular classes). Splitting this into two distinct macros allows to use them in all contexts. See \href{https://stackoverflow.com/q/50202718/9385966}{\texttt{ https\+://stackoverflow.\+com/q/50202718/9385966}} for more details.
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em \+\_\+batch\+\_\+lin\+\_\+op} & concrete operator for which the factory is to be created \mbox{[}C\+R\+TP parameter\mbox{]} \\
\hline
{\em \+\_\+parameters\+\_\+name} & name of the parameters member in the class (its type is {\ttfamily $<$\+\_\+parameters\+\_\+name$>$\+\_\+type}, the protected member\textquotesingle{}s name is {\ttfamily $<$\+\_\+parameters\+\_\+name$>$\+\_\+}, and the public getter\textquotesingle{}s name is {\ttfamily get\+\_\+$<$\+\_\+parameters\+\_\+name$>$()}) \\
\hline
{\em \+\_\+factory\+\_\+name} & name of the generated factory type \\
\hline
\end{DoxyParams}


\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{group__BatchLinOp_ga544616e42045fcd07bfb3799d304eb0c}\label{group__BatchLinOp_ga544616e42045fcd07bfb3799d304eb0c}} 
\index{BatchLinOp@{BatchLinOp}!EnableDefaultBatchLinOpFactory@{EnableDefaultBatchLinOpFactory}}
\index{EnableDefaultBatchLinOpFactory@{EnableDefaultBatchLinOpFactory}!BatchLinOp@{BatchLinOp}}
\doxysubsubsection{\texorpdfstring{EnableDefaultBatchLinOpFactory}{EnableDefaultBatchLinOpFactory}}
{\footnotesize\ttfamily template$<$typename Concrete\+Factory , typename Concrete\+Batch\+Lin\+Op , typename Parameters\+Type , typename Polymorphic\+Base  = Batch\+Lin\+Op\+Factory$>$ \\
using \mbox{\hyperlink{group__BatchLinOp_ga544616e42045fcd07bfb3799d304eb0c}{gko\+::batch\+::\+Enable\+Default\+Batch\+Lin\+Op\+Factory}} = typedef \mbox{\hyperlink{classgko_1_1EnableDefaultFactory}{Enable\+Default\+Factory}}$<$Concrete\+Factory, Concrete\+Batch\+Lin\+Op, Parameters\+Type, Polymorphic\+Base$>$}



This is an alias for the \mbox{\hyperlink{classgko_1_1EnableDefaultFactory}{Enable\+Default\+Factory}} mixin, which correctly sets the template parameters to enable a subclass of \mbox{\hyperlink{classgko_1_1batch_1_1BatchLinOpFactory}{Batch\+Lin\+Op\+Factory}}. 


\begin{DoxyTemplParams}{Template Parameters}
{\em Concrete\+Factory} & the concrete factory which is being implemented \mbox{[}C\+R\+TP parameter\mbox{]} \\
\hline
{\em Concrete\+Batch\+Lin\+Op} & the concrete \mbox{\hyperlink{classgko_1_1batch_1_1BatchLinOp}{Batch\+Lin\+Op}} type which this factory produces, needs to have a constructor which takes a const Concrete\+Factory $\ast$, and an std\+::shared\+\_\+ptr$<$const Batch\+Lin\+Op$>$ as parameters. \\
\hline
{\em Parameters\+Type} & a subclass of \mbox{\hyperlink{classgko_1_1enable__parameters__type}{enable\+\_\+parameters\+\_\+type}} template which defines all of the parameters of the factory \\
\hline
{\em Polymorphic\+Base} & parent of Concrete\+Factory in the polymorphic hierarchy, has to be a subclass of \mbox{\hyperlink{classgko_1_1batch_1_1BatchLinOpFactory}{Batch\+Lin\+Op\+Factory}} \\
\hline
\end{DoxyTemplParams}
